Така имаме за задача да изградим система за нотификации. Системата трябва да предлага нотификации за всякакви устройства. Пуш нотификации за андроид и iOS, смс нотификации и имейл нотификации. Известията трябва да се изпращат възможно най-бързо, нямаме изикване да са real-time, но възмжно най-близко до real-time. Заявките за известия могат да бъдат пускани от някакъв клиент или директно от сървъра. Трябва да поддържаме:
- 10М пуш нотификации/ден
- 5М имейли/ден
- 1М СМС-и/ден

На високо ниво дизнайна ни може да се състои от следните компоненти централен сървър, който:
1. Събира и пази данни за потребителя и устройството му. Тези данни се пазят в база данни, която можем да изградим с таблица потрбител (име, имейл, телефонен номер) и таблица устройство (вид устройство и идентификационен токен). Тези данни могат да бъдат изискани при регистрация или на друг етап.
2. Изгражда и изпраща заявки за известия, така нареченият Provider. Той взима адресата и изгражда payload, според изискванията на услугата за нотификация и изпраща заявка.
3. Трети лица - Това са услуги, които ни трябват за самото изпращане на известие до потребителя. Най-известни са следните услуги:
	- Apple Push Notification Service (APNS), просто изпращаме токена на устройството и пейлоад-а и тази услуга препраща известието на iOS потребителя 
	- Firebase Cloud Messaging FCM, работи подобно, но за Андроид
	- Twillo, за СМС-и
	- Mailchimp, за имейл-и

От тук вече можем да подобрим системата си. Първо нека да скейлнем хоризонтално сървъра. Можем да скалираме и базата данни, според нуждите ни, би било удачно да имаме реплики с цел да подобрим consistency & avalability-то. Така се справяме и с SPF проблема, който имахме. Можем да добавим кеш за потребителите, който се достъпват често и за други ресурси, които ще ни трябва, като например notification template-и.
Вече сме скалирали сървъра, би било удачно да не го блокираме при всяка заявка, понякога изпращането на известие може да отнеме много време, за това можем да установим message queue, за всяка услуга, която предоставяме апъл, андроид пуш нотификации, смс-и и имейли. Всяко кю има определени worker-и, които го полват и изпълняват тасковете, когато са свободни.

Довършителни задачи са:
- Да се установи retry механизъм, в случай на аномалия, когато един таск дропне, нека да се enqueue-ва в retry queue. В случай, че Н на брой пъти фейлне трябва да се прати на някого за да се разгледа.
- Да се установи дедупликиращ механизъм. Не искаме да изпращаме една и съща нотификация множество пъти, а това е реална възможност поради факта, че имаме дистрибутирана система.
- Споменахме темплейти за известия, би било умно да имаме такива, понеже повечето нотификации следават подобен формат, следователно лесно можем да изграждаме известия.
- Трябва да дадем възможност на потребителя да зададе настройки, които се отказват от известия или ги лимитират
- Трябва ние самите да направим рейт лимит за броят на известията, които могат да се пратят на един потребител за определен период от време. Не искаме да сме неучтиви и съответно да откажем потребителя от услугата ни.
- Трябва да установим мониторин механизъм за броя известия, които преработваме за определен интервал от време за да преценим ресурса, който трябва да използваме. Също така би било удачно и да монитор-ваме статуса и engagement-а на известията, например за колко време се изпраща една нотификация и колко често се кликва опеределен формат известие.